@import "reset.scss";

$ledBorder: #140808;
$ledRed: #f80000;
$ledBackground: #200000;

$ledRedGlowInner: #f60304;
$ledRedGlowOuter: #7b1916;

@function longshadow($color_a, $color_b, $stepnum, $opacity: 1){
    $gradient_steps: null;

    @for $i from 1 through $stepnum {
        $weight: (($i - 1) / $stepnum) * 100;
        $colour_mix: mix($color_b, rgba($color_a, $opacity), $weight);
        $seperator: null;

        @if ($i != $stepnum) {
            $seperator: #{','};
        }

        $gradient_steps: append(#{$gradient_steps}, #{$i}px #{$i}px $colour_mix $seperator);
    }

    @return $gradient_steps;
}

body {
    font-family: sans-serif;
    font-size: 12px;
}

svg text {
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
}

.flex-row {
    display: flex;

    &.wide-spacing > * + * {
        margin-left: 64px;
    }

    &.narrow-spacing > * + * {
        margin-left: 8px;
    }
}

.flex-column {
    display: flex;
    flex-direction: column;

    &.wide-spacing > * + * {
        margin-top: 64px;
    }

    &.narrow-spacing > * + * {
        margin-top: 8px;
    }
}

.flex-1 {
    flex: 1;
}

#root {
    position: relative;
    height: 100vh;
    display: flex;
    flex-direction: column;
    padding: 64px;

    align-items: left;

    // Prevent margin on child from pushing down backdrop
    overflow: hidden;
}

.backdrop {
    position: absolute;
    top: 0;
    left: 0;
    bottom: 0;
    right: 0;
    z-index: -1;
}

.box {
    background: #f8f8f8;
    //margin: 64px 80px 64px 64px;
    padding: 32px;
    //box-shadow: 0px 10px 20px rgba(0, 0, 0, 0.4);
    display: flex;

    border: 1px solid #e0e0e0;
    box-shadow: 0px 0px 2px #eee, longshadow(#ddd, #aaa, 16, 1.0), 16px 16px 8px rgba(0, 0, 0, 0.8);

    &.dark {
        background: #444;
        border: 1px solid #282828;
        box-shadow: 0px 0px 2px #383838, longshadow(#333, #222, 16, 1.0), 16px 16px 8px rgba(0, 0, 0, 0.8);
    }
}

.pattern {
    display: flex;
    flex: 1;

    background: #111;
    padding: 8px;
    border-radius: 4px;
    box-shadow: 0px 1px 1px #ffffff80, 0px -1px 1px #00000040;
}

.pattern-box {
    padding: 8px;
    border-radius: 2px;
}

.step {
    display: flex;
    flex: 1;
    flex-direction: column;

    margin: 0 2px;

    & + & {
        margin-left: 0;
    }

    &.current {
        .note {
            background: lighten($ledBackground, 3);

            &.black-key {
                background: lighten($ledBackground, 1);
            }

            &.selected {
                background: radial-gradient(circle farthest-side at center, lighten($ledRedGlowInner, 1), lighten($ledRedGlowOuter, 1));
            }
        }

        .step-indicator {
            background: red;
        }
    }

    .step-indicator {
        background: $ledBackground;
    }
}

.step-indicator {
    height: 4px;
}

.piano-roll {
    display: flex;
    flex-direction: column;
    margin: 0 2px;

    .gap {
        height: 56px;
    }
}

.piano-key {
    flex: 1;
    background: #eee;
    border-top-right-radius: 4px;
    border-bottom-right-radius: 4px;
    margin: 2px 0;
    padding: 0 16px;

    & + & {
        margin-top: 0;
    }

    &.black-key {
        background: #333;
        color: #eee;
    }
}

.note {
    //background: #ddd;
    flex: 1;
    margin: 2px 0;
    cursor: pointer;
    border-radius: 3px;

    background: $ledBackground;
    box-shadow: inset 0px 0px 2px $ledBackground;

    //padding-top: 100%;

    & + & {
        margin-top: 0;
    }

    &.black-key {
        background: darken($ledBackground, 3);
    }

    &.selected {
        //background: #cc0000d0;
        background: radial-gradient(circle farthest-side at center, $ledRedGlowInner, $ledRedGlowOuter);
    }
}

.modifiers {
    display: flex;
    flex-direction: row;
    margin-top: 4px;

    & > * + * {
        margin-left: 4px;
    }
}

.modifier {
    border: 1px solid #333;
    border-radius: 4px;
    height: 22px;
    color: #aaa;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 14px;

    & + & {
        margin-top: 4px;
    }

    &.active {
        background: #888;
        color: #222;
        border-color: #aaa;
    }
}

.display {
    display: inline-block;
    background: $ledBackground;
    box-shadow: inset 0px 0px 1px 4px $ledBorder, 0px 1px 1px #ffffff80, 0px -1px 1px #00000040;
    padding: 8px;
    color: $ledRed;
    border-radius: 4px;
}
